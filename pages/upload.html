{% include pages/header.html %}

<script>

  function getLocation() {
     navigator.geolocation.getCurrentPosition(showPosition, (error) => {

      const form = document.getElementById("upload-form");
      form.querySelector('[name="lat"]').value = "UNABLE TO LOAD";
      form.querySelector('[name="long"]').value = "UNABLE TO LOAD";

     });
  }

  function showPosition(position) {

    const form = document.getElementById("upload-form");
    form.querySelector('[name="lat"]').value = position.coords.latitude;
    form.querySelector('[name="long"]').value = position.coords.longitude;
  }

  window.addEventListener("load", getLocation)

</script>

<div id = "subheader">
<a href="/">
<img class = "back-button" src = "static/back.png">
</a>
  <h1>New Post</h1>
</div>
<div class = "upload-content">
  <div id = "current-meme">
    <img class="spinning" src="{{ meme_of_week_img }}">
    <p>MEME OF THE WEEK</p>
  </div>
  <form id = "upload-form" method = "post" enctype = "multipart/form-data"> 
    <input name="username" type="text" placeholder="Username" required>
    <input id = "choose-file" name="photo" type="file" accept = "image/*;capture=camera" required>
    <input name="caption" type="text" placeholder="Enter Caption" required>
    <input name="location" type="text" placeholder="Enter Location" required>
    <input class = "lat" name="lat" type="text" placeholder="Latitude" readonly>
    <input class = "long" name="long" type="text" placeholder="Longitude" readonly>
  </form>
  <button type="submit" form="upload-form" value="Submit" id="sendbutton">Submit</button>
</div>
<script>
  document.getElementById("upload-form").addEventListener("submit", disableButton);

  function disableButton() {
    document.getElementById("sendbutton").disabled = "false";
    return true;
  }
</script>
